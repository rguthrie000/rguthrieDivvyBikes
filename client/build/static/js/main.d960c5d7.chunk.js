(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{158:function(e,t,a){e.exports=a(312)},163:function(e,t,a){},181:function(e,t,a){},203:function(e,t,a){},204:function(e,t,a){},311:function(e,t,a){},312:function(e,t,a){"use strict";a.r(t);var n=a(3),i=a.n(n),r=a(88),o=a.n(r),l=(a(163),a(65)),c=a(34),s=a(45),d=a(53),u=a.n(d),m=[],p={getKey:function(e){u.a.get("/api/mapkey").then(function(t){e(t.data)})},getStations:function(e){u.a.get("/api/stations").then(function(t){var a=[];t.data.forEach(function(e){a.push({stationId:e.stationId,stationName:e.stationName,docks:e.docks,stationLat:e.stationLat,stationLon:e.stationLon})}),e(a)}).catch(function(e){return console.log(e)})},getTrips:function(e,t,a){var n={startStation:e.list[e.startIndex].stationId,endStation:e.list[e.endIndex].stationId,useStartTime:!1};console.log("getTrips 1st query",n),m=[],u.a.post("/api/trips",n).then(function(t){t.data.forEach(function(e){return m.push({startTime:e.startTime+31449600,tripDuration:e.tripDuration})}),console.log("1st query: ".concat(t.data.length," trips")),n=Object(c.a)({},n,{startStation:e.list[e.endIndex].stationId,endStation:e.list[e.startIndex].stationId}),console.log("getTrips 2nd query",n),u.a.post("/api/trips",n).then(function(e){e.data.forEach(function(e){return m.push({startTime:e.startTime+62899200,tripDuration:e.tripDuration})}),console.log("2nd query: ".concat(e.data.length," trips")),a(m)})})}},h={latLo:41.736646,latHi:42.064854,lonLo:-87.774704,lonHi:-87.549386},f={randLat:function(){return h.latLo+Math.random()*(h.latHi-h.latLo)},randLon:function(){return h.lonLo+Math.random()*(h.lonHi-h.lonLo)},divvyLimits:function(){return h},findClosestStation:function(e,t,a){for(var n=a.map(function(a){return Math.pow(a.stationLat-e,2)+Math.pow(a.stationLon-t,2)}),i=1e6,r=-1,o=0;o<n.length;o++)n[o]<i&&(r=o,i=n[o]);return{minIndex:r,minDist:i=Math.sqrt(i)*(Math.PI/180)*3957.66}}};a(181);var g=function(e){return i.a.createElement(i.a.Fragment,null,i.a.createElement("h6",{id:"timedate"},e.timeAndDate),i.a.createElement("h6",{id:"timecat"},e.isWeekday?"weekday":"weekend",", ",e.partOfDay),i.a.createElement("div",{id:"search-box"},i.a.createElement("div",null,i.a.createElement("div",{id:"button-random"},i.a.createElement("button",{className:"button-random",onClick:e.whereAmI},"random")),i.a.createElement("label",{id:"position-lat-label",htmlFor:"position-lat"},"Location: lat"),i.a.createElement("div",{id:"position-lat",className:"number-box",value:e.title,name:"position-lat"},i.a.createElement("p",null,e.lat)),i.a.createElement("label",{id:"position-lon-label",htmlFor:"position-lon"},"lon"),i.a.createElement("div",{id:"position-lon",className:"number-box",value:e.author,name:"position-lon"},e.lon)),i.a.createElement("p",{id:"minDistance"},"from this location, ",e.minStationDist," miles to:"),i.a.createElement("div",null,i.a.createElement("label",{id:"start-station-id-label",htmlFor:"start-station-id"},"Start Station id & name"),i.a.createElement("div",{id:"start-station-id"},e.startStation),i.a.createElement("div",{id:"start-station",className:"number-box",value:e.subject,name:"start-station"},e.startName)),i.a.createElement("div",null,i.a.createElement("label",{id:"end-station-id-label",htmlFor:"end-station-id"},"Destination Station id & name"),i.a.createElement("div",{id:"end-station-id"},e.endStation),i.a.createElement("div",{id:"end-station",className:"form-input",value:e.subject,name:"end-station"},e.endName))),i.a.createElement("div",{id:"radio-box-location"},i.a.createElement("p",null,"Map click:"),i.a.createElement("div",{className:"form-check"},i.a.createElement("label",null,i.a.createElement("input",{type:"radio",name:"clickStart",value:"start",className:"form-check-input",checked:e.clickStart,onChange:e.handleClickStart}),"start")),i.a.createElement("div",{className:"form-check"},i.a.createElement("label",null,i.a.createElement("input",{type:"radio",name:"clickStart",value:"end",className:"form-check-input",checked:!e.clickStart,onChange:e.handleClickStart}),"destination"))),i.a.createElement("div",{id:"radio-box-time"},i.a.createElement("p",null,"Use day & time?"),i.a.createElement("div",{className:"form-check"},i.a.createElement("label",null,i.a.createElement("input",{type:"radio",name:"useTime",value:"yes",className:"form-check-input",checked:e.useTime,onChange:e.handleRadio}),"yes")),i.a.createElement("div",{className:"form-check"},i.a.createElement("label",null,i.a.createElement("input",{type:"radio",name:"useTime",value:"no",className:"form-check-input",checked:!e.useTime,onChange:e.handleRadio}),"no"))),i.a.createElement("div",{id:"radio-box-profile"},i.a.createElement("p",null,"Use user profile?"),i.a.createElement("div",{className:"form-check"},i.a.createElement("label",null,i.a.createElement("input",{type:"radio",name:"useProfile",value:"yes",className:"form-check-input",checked:e.useProfile,onChange:e.handleRadio}),"yes")),i.a.createElement("div",{className:"form-check"},i.a.createElement("label",null,i.a.createElement("input",{type:"radio",name:"useProfile",value:"no",className:"form-check-input",checked:!e.useProfile,onChange:e.handleRadio}),"no"))))},v=a(144),b=a.n(v),k=(a(203),function(e){var t=e.text;e.background;return i.a.createElement("div",{style:{color:"white",background:"gray",padding:"0px 1px",display:"inline-flex",textAlign:"center",alignItems:"center",justifyContent:"center",borderRadius:"100%",transform:"translate(-50%, -50%)"}},t)}),E=function(e){var t=e.text;e.background;return i.a.createElement("div",{style:{color:"white",background:"magenta",padding:"0px 1px",display:"inline-flex",textAlign:"center",alignItems:"center",justifyContent:"center",borderRadius:"100%",transform:"translate(-50%, -50%)"}},t)},y=function(e){var t=e.text;e.background;return i.a.createElement("div",{style:{color:"white",background:"green",padding:"0px 1px",display:"inline-flex",textAlign:"center",alignItems:"center",justifyContent:"center",borderRadius:"100%",transform:"translate(-50%, -50%)"}},t)},D=function(e){var t=e.text;e.background;return i.a.createElement("div",{style:{color:"white",background:"red",padding:"0px 1px",display:"inline-flex",textAlign:"center",alignItems:"center",justifyContent:"center",borderRadius:"100%",transform:"translate(-50%, -50%)"}},t)};function x(e){e.keyVal;var t=e.centerLat,a=e.centerLon,n=e.stations,r=e.startStation,o=e.endStation,l=e.mapClick,c={center:{lat:41.90075,lng:-87.65},zoom:11};return i.a.createElement(b.a,{onClick:l,bootstrapURLKeys:{key:"AIzaSyAcAthdRfN4aH4z75JtzKI3UXDFZxmw_V4"},defaultCenter:c.center,defaultZoom:c.zoom,yesIWantToUseGoogleMapApiInternals:!0},n.map(function(e,t){return i.a.createElement(k,{key:t,lat:e.stationLat,lng:e.stationLon,text:"*",background:"gray"})}),i.a.createElement(E,{lat:t,lng:a,text:"loc"}),i.a.createElement(y,{lat:r.stationLat,lng:r.stationLon,text:"start"}),i.a.createElement(D,{lat:o.stationLat,lng:o.stationLon,text:"dest"}))}var S=function(e){var t=e.keyVal,a=e.centerLat,n=e.centerLon,r=e.stations,o=e.startStation,l=e.endStation,c=e.mapClick;return i.a.createElement("div",{id:"map",className:"card mapcard"},i.a.createElement(x,{keyVal:t,centerLat:a,centerLon:n,stations:r,startStation:o,endStation:l,mapClick:c}))},N=a(323),w=a(326),I=a(325),O=a(321);a(204);function T(e){return i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{className:"chart-summary"},"Average Ride Time ",i.a.createElement("span",{id:"average"},e.averageDuration)),i.a.createElement("div",{id:"canvas"},i.a.createElement(N.a,{domainPadding:20,theme:w.a.material},i.a.createElement(I.a,{tickValues:e.labels}),i.a.createElement(I.a,{dependentAxis:!0,tickFormat:function(e){return"".concat(e)}}),i.a.createElement(O.a,{data:e.binTrips,x:"bin",y:"trips"}))),i.a.createElement("div",{className:"chart-detail"},"standard deviation ",i.a.createElement("span",{id:"std-dev"},e.stdDevDuration)))}var L=a(91);a(311);var C=function(){var e=Object(n.useState)({populated:0,keyVal:"",startIndex:42,endIndex:505,list:[],latitude:f.randLat(),longitude:f.randLon(),minStationDist:0}),t=Object(s.a)(e,2),a=t[0],r=t[1],o=Object(n.useState)({useTime:!1,useProfile:!1}),d=Object(s.a)(o,2),u=d[0],m=d[1],h=Object(n.useState)(),v=Object(s.a)(h,2),b=v[0],k=v[1],E=Object(n.useState)({timeStr:"",isWeekday:0,isOvernight:0,isMorning:0,isAfternoon:0,isEvening:0}),y=Object(s.a)(E,2),D=y[0],x=y[1],N=Object(n.useState)({minDuration:"",maxDuration:"",averageDuration:"",stdDevDuration:"",labels:[],binTrips:[]}),w=Object(s.a)(N,2),I=w[0],O=w[1];function C(e){r(Object(c.a)({},a,{keyVal:e})),console.log("received keyVal ".concat(e))}function M(e){var t=f.findClosestStation(a.latitude,a.longitude,e);r(Object(c.a)({},a,{populated:a.populated+1,list:e,minStationDist:t.minDist,startIndex:t.minIndex}))}function j(e){if(console.log("pushed to trips ",JSON.stringify(e)),0===e.length)O({minDuration:0,maxDuration:0,averageDuration:"--:--",stdDevDuration:"--:--",binTrips:[]});else{console.log("tripStats ",e.length),e.sort(function(e,t){return e.tripDuration-t.tripDuration});var t=e.reduce(function(e,t){return e+t.tripDuration},0)/e.length;console.log("mean ".concat(t));var a=e.reduce(function(e,a){return e+Math.pow(a.tripDuration-t,2)},0)/(e.length>1?e.length-1:1),n=Math.sqrt(a);console.log("stdDev ".concat(n)),e=e.filter(function(e){return Math.abs(e.tripDuration-t)<=3*n}),t=e.reduce(function(e,t){return e+t.tripDuration},0)/e.length,console.log("mean (reduce) ".concat(t)),a=e.reduce(function(e,a){return e+Math.pow(a.tripDuration-t,2)},0)/(e.length>1?e.length-1:1),n=Math.sqrt(a),console.log("stdDev (reduce) ".concat(n));for(var i=e[e.length-1].tripDuration-e[0].tripDuration,r=e[0].tripDuration,o=.1*i,l=0,c=[],s=[],d=0,u=0;u<10&&d<e.length;u++){for(var m=0;d<e.length&&e[d].tripDuration<r+(u+1)*o;)m++,d++;m>l&&(l=m),s.push("".concat(u%2?"-":W((u+.5)*o+r))),c.push({bin:u+1,trips:m})}console.log("baseDuration ".concat(r," durationStep ").concat(o)),console.log("avgD ".concat(t," s =").concat(Math.floor(t/60)+":"+t%60," stdDev ").concat(n," s = ").concat(Math.floor(n/60)+":"+n%60)),console.log("maxbinCt ".concat(l),JSON.stringify(c)),O({minDuration:e[0].tripDuration,maxDuration:e[e.length-1].tripDuration,averageDuration:W(t),stdDevDuration:W(n),labels:s,binTrips:c})}}function A(){var e=Object(L.getTimeStr)(),t=Object(L.getTimeFlags)(e);x({timeStr:e,isWeekday:t.isWeekday,isOvernight:t.isOvernight,isMorning:t.isMorning,isAfternoon:t.isAfternoon,isEvening:t.isEvening})}function W(e){var t=Math.floor(e%60);return Math.floor(e/60)+":"+(t=t<10?"0"+t:t)}return Object(n.useEffect)(function(){a.list.length||(setInterval(A,1e3),k(!0),p.getKey(C),p.getStations(M))},[]),i.a.createElement("div",{className:"container AppBar"},i.a.createElement("div",{className:"row AppBar-header"},i.a.createElement("div",{id:"nameBox"},i.a.createElement("h5",null,"rguthrie's"),i.a.createElement("h4",null,"Divvy Bikes Planner"),i.a.createElement("div",{className:"smallprint"},i.a.createElement("br",null),i.a.createElement("p",null,"copyright \xa9 rguthrie, 2020"))),i.a.createElement("h1",{className:"AppBar-title"},"Bike Chicago!")),i.a.createElement("div",{className:"row"},i.a.createElement("div",{className:"col-sm-4"},i.a.createElement("div",{className:"row info-card"},i.a.createElement(g,{timeAndDate:D.timeStr,isWeekday:D.isWeekday,partOfDay:D.isOvernight?"overnight":D.isMorning?"morning":D.isEvening?"evening":"afternoon",lat:a.latitude.toPrecision(8),lon:a.longitude.toPrecision(8),startStation:a.populated?a.list[a.startIndex].stationId:"",startName:a.populated?a.list[a.startIndex].stationName:"",endStation:a.populated?a.list[a.endIndex].stationId:"",endName:a.populated?a.list[a.endIndex].stationName:"",minStationDist:a.minStationDist.toPrecision(3),useTime:u.useTime,useProfile:u.useProfile,whereAmI:function(e){e.preventDefault();var t=f.randLat(),n=f.randLon(),i=f.findClosestStation(t,n,a.list);r(Object(c.a)({},a,{latitude:t,longitude:n,minStationDist:i.minDist,startIndex:i.minIndex})),p.getTrips(a,u,j)},clickStart:b,handleRadio:function(e){e.preventDefault();var t=e.target.name,a=e.target.value;m(Object(c.a)({},u,Object(l.a)({},t,"yes"===a)))},handleClickStart:function(e){e.preventDefault();var t=e.target.value;k("start"===t)}})),i.a.createElement("div",{className:"row chart-card"},i.a.createElement(T,{minDuration:I.minDuration,maxDuration:I.maxDuration,averageDuration:I.averageDuration,stdDevDuration:I.stdDevDuration,labels:I.labels,binTrips:I.binTrips}))),i.a.createElement("div",{className:"col-sm-8"},42===a.startIndex?i.a.createElement("div",null):i.a.createElement(S,{keyVal:a.keyVal,centerLat:a.latitude,centerLon:a.longitude,stations:a.populated?a.list:[],startStation:a.populated?a.list[a.startIndex]:{},endStation:a.populated?a.list[a.endIndex]:{},mapClick:function(e){var t=e.x,n=e.y,i=e.lat,o=e.lng;console.log(t,n,i,o);var l=f.findClosestStation(i,o,a.list);r(Object(c.a)({},a,{latitude:b?i:a.latitude,longitude:b?o:a.longitude,minStationDist:b?l.minDist:a.minStationDist,startIndex:b?l.minIndex:a.startIndex,endIndex:b?a.endIndex:l.minIndex})),p.getTrips(a,u,j)}}))))},M=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function j(e){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var t=e.installing;t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))}}}).catch(function(e){console.error("Error during service worker registration:",e)})}o.a.render(i.a.createElement(C,null),document.getElementById("root")),function(){if("serviceWorker"in navigator){if(new URL("",window.location).origin!==window.location.origin)return;window.addEventListener("load",function(){var e="".concat("","/service-worker.js");M?function(e){fetch(e).then(function(t){404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):j(e)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(e):j(e)})}}()},91:function(e,t){var a=[15836544e5,1604214e6];e.exports={getTimeStr:function(){var e=Date.now();e<a[0]?e-=216e5:e<a[1]&&(e-=18e6);var t=new Date(e);return(t=t.toUTCString()).slice(0,25)+" CT"},getTimeFlags:function(e){var t=e.split(" "),a=!1;switch(t[0]){case"Mon,":case"Tue,":case"Wed,":case"Thu,":case"Fri,":a=!0;break;case"Sat,":case"Sun,":a=!1}var n=t[4].split(":")[0],i=!1,r=!1,o=!1,l=!1;return n<6?l=!0:n<12?i=!0:n<18?r=!0:o=!0,{isWeekday:a,isMorning:i,isAfternoon:r,isEvening:o,isOvernight:l}},makeLocalTime:function(e,t){var a={},n=new Date(1e3*(e+t)).toUTCString().split(" ");switch(a.year=n[3],a.monthNameShort=n[2],n[2]){case"Jan":a.month=1,a.monthName="January";break;case"Feb":a.month=2,a.monthName="February";break;case"Mar":a.month=3,a.monthName="March";break;case"Apr":a.month=4,a.monthName="April";break;case"May":a.month=5,a.monthName="May";break;case"Jun":a.month=6,a.monthName="June";break;case"Jul":a.month=7,a.monthName="July";break;case"Aug":a.month=8,a.monthName="August";break;case"Sep":a.month=9,a.monthName="September";break;case"Oct":a.month=10,a.monthName="October";break;case"Nov":a.month=11,a.monthName="November";break;case"Dec":a.month=12,a.monthName="December"}switch(a.dayOfMonth=n[1],n[0]){case"Mon,":a.dayOfWeek="Monday";break;case"Tue,":a.dayOfWeek="Tuesday";break;case"Wed,":a.dayOfWeek="Wednesday";break;case"Thu,":a.dayOfWeek="Thursday";break;case"Fri,":a.dayOfWeek="Friday";break;case"Sat,":a.dayOfWeek="Saturday";break;case"Sun,":a.dayOfWeek="Sunday"}var i=n[4].split(":");return a.hour=i[0],a.minute=i[1],a.second=i[2],a}}}},[[158,1,2]]]);
//# sourceMappingURL=main.d960c5d7.chunk.js.map