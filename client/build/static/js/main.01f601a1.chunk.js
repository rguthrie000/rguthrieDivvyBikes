(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{159:function(e,t,a){e.exports=a(313)},164:function(e,t,a){},182:function(e,t,a){},204:function(e,t,a){},205:function(e,t,a){},312:function(e,t,a){},313:function(e,t,a){"use strict";a.r(t);var n=a(3),i=a.n(n),o=a(88),r=a.n(o),l=(a(164),a(65)),c=a(37),s=a(45),d=a(53),m=a.n(d),u=a(89),p=[],h={getKey:function(e){m.a.get("/api/mapkey").then(function(t){e(t.data)})},getStations:function(e){m.a.get("/api/stations").then(function(t){var a=[];t.data.forEach(function(e){a.push({stationId:e.stationId,stationName:e.stationName,docks:e.docks,stationLat:e.stationLat,stationLon:e.stationLon})}),e(a)}).catch(function(e){return console.log(e)})},getTrips:function(e,t,a){var n={startStation:e.list[e.startIndex].stationId,endStation:e.list[e.endIndex].stationId,useStartTime:!1};u.debug&&console.log("getTrips 1st query",n),p=[],m.a.post("/api/trips",n).then(function(t){t.data.forEach(function(e){return p.push({startTime:e.startTime+31449600,tripDuration:e.tripDuration})}),u.debug&&console.log("1st query: ".concat(t.data.length," trips")),n=Object(c.a)({},n,{startStation:e.list[e.endIndex].stationId,endStation:e.list[e.startIndex].stationId}),console.log("getTrips 2nd query",n),m.a.post("/api/trips",n).then(function(e){e.data.forEach(function(e){return p.push({startTime:e.startTime+62899200,tripDuration:e.tripDuration})}),console.log("2nd query: ".concat(e.data.length," trips")),a(p)})})}},g={latLo:41.736646,latHi:42.064854,lonLo:-87.774704,lonHi:-87.549386},f=[65,73,122,97,83,121,65,99,65,116,104,100,82,102,78,52,97,72,52,122,55,53,74,116,122,75,73,51,85,88,68,70,90,120,109,119,95,86,52],v={randLat:function(){return g.latLo+Math.random()*(g.latHi-g.latLo)},randLon:function(){return g.lonLo+Math.random()*(g.lonHi-g.lonLo)},divvyLimits:function(){return g},centerSkew:function(){return String.fromCharCode.apply(String,f)},findClosestStation:function(e,t,a){for(var n=a.map(function(a){return Math.pow(a.stationLat-e,2)+Math.pow(a.stationLon-t,2)}),i=1e6,o=-1,r=0;r<n.length;r++)n[r]<i&&(o=r,i=n[r]);return{minIndex:o,minDist:i=Math.sqrt(i)*(Math.PI/180)*3957.66}}};a(182);var b=function(e){return i.a.createElement(i.a.Fragment,null,i.a.createElement("h6",{id:"timedate"},e.timeAndDate),i.a.createElement("h6",{id:"timecat"},e.isWeekday?"weekday":"weekend",", ",e.partOfDay),i.a.createElement("div",{id:"search-box"},i.a.createElement("div",null,i.a.createElement("div",{id:"button-random"},i.a.createElement("button",{className:"button-random",onClick:e.whereAmI},"random")),i.a.createElement("label",{id:"position-lat-label",htmlFor:"position-lat"},"Location: lat"),i.a.createElement("div",{id:"position-lat",className:"number-box",value:e.title,name:"position-lat"},i.a.createElement("p",null,e.lat)),i.a.createElement("label",{id:"position-lon-label",htmlFor:"position-lon"},"lon"),i.a.createElement("div",{id:"position-lon",className:"number-box",value:e.author,name:"position-lon"},e.lon)),i.a.createElement("p",{id:"minDistance"},"from this location, ",e.minStationDist," miles to:"),i.a.createElement("div",null,i.a.createElement("label",{id:"start-station-id-label",htmlFor:"start-station-id"},"Start Station id & name"),i.a.createElement("div",{id:"start-station-id"},e.startStation),i.a.createElement("div",{id:"start-station",className:"number-box",value:e.subject,name:"start-station"},e.startName)),i.a.createElement("div",null,i.a.createElement("label",{id:"end-station-id-label",htmlFor:"end-station-id"},"Destination Station id & name"),i.a.createElement("div",{id:"end-station-id"},e.endStation),i.a.createElement("div",{id:"end-station",className:"form-input",value:e.subject,name:"end-station"},e.endName))),i.a.createElement("div",{id:"radio-box-location"},i.a.createElement("p",null,"Map click:"),i.a.createElement("div",{className:"form-check"},i.a.createElement("label",null,i.a.createElement("input",{type:"radio",name:"clickStart",value:"start",className:"form-check-input",checked:e.clickStart,onChange:e.handleClickStart}),"start")),i.a.createElement("div",{className:"form-check"},i.a.createElement("label",null,i.a.createElement("input",{type:"radio",name:"clickStart",value:"end",className:"form-check-input",checked:!e.clickStart,onChange:e.handleClickStart}),"destination"))),i.a.createElement("div",{id:"radio-box-time"},i.a.createElement("p",null,"Use day & time?"),i.a.createElement("div",{className:"form-check"},i.a.createElement("label",null,i.a.createElement("input",{type:"radio",name:"useTime",value:"yes",className:"form-check-input",checked:e.useTime,onChange:e.handleRadio}),"yes")),i.a.createElement("div",{className:"form-check"},i.a.createElement("label",null,i.a.createElement("input",{type:"radio",name:"useTime",value:"no",className:"form-check-input",checked:!e.useTime,onChange:e.handleRadio}),"no"))),i.a.createElement("div",{id:"radio-box-profile"},i.a.createElement("p",null,"Use user profile?"),i.a.createElement("div",{className:"form-check"},i.a.createElement("label",null,i.a.createElement("input",{type:"radio",name:"useProfile",value:"yes",className:"form-check-input",checked:e.useProfile,onChange:e.handleRadio}),"yes")),i.a.createElement("div",{className:"form-check"},i.a.createElement("label",null,i.a.createElement("input",{type:"radio",name:"useProfile",value:"no",className:"form-check-input",checked:!e.useProfile,onChange:e.handleRadio}),"no"))))},k=a(145),E=a.n(k);a(204);function D(e){var t=e.centerSkew,a=e.centerLat,n=e.centerLon,o=e.stations,r=e.startStation,l=e.endStation,c=e.mapClick,s={center:{lat:41.90075,lng:-87.65},zoom:11},d=function(e){return i.a.createElement("div",{style:{color:"white",background:e.bkgnd,padding:"0px 1px",display:"inline-flex",textAlign:"center",alignItems:"center",justifyContent:"center",borderRadius:"100%",transform:"translate(-50%, -50%)"}},e.text)};return i.a.createElement("div",{id:"map",className:"card mapcard"},i.a.createElement(E.a,{onClick:c,bootstrapURLKeys:t,defaultCenter:s.center,defaultZoom:s.zoom,yesIWantToUseGoogleMapApiInternals:!0},o.map(function(e,t){return i.a.createElement(d,{key:t,lat:e.stationLat,lng:e.stationLon,text:"*",bkgnd:"gray"})}),i.a.createElement(d,{lat:a,lng:n,text:"loc",bkgnd:"magenta"}),i.a.createElement(d,{lat:r.stationLat,lng:r.stationLon,text:"start",bkgnd:"green"}),i.a.createElement(d,{lat:l.stationLat,lng:l.stationLon,text:"dest",bkgnd:"red"})))}var S=a(324),y=a(327),N=a(326),x=a(322);a(205);function w(e){return i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{className:"chart-summary"},"Average Ride Time ",i.a.createElement("span",{id:"average"},e.averageDuration)),i.a.createElement("div",{id:"canvas"},i.a.createElement(S.a,{domainPadding:20,theme:y.a.material},i.a.createElement(N.a,{tickValues:e.labels}),i.a.createElement(N.a,{dependentAxis:!0,tickFormat:function(e){return"".concat(e)}}),i.a.createElement(x.a,{data:e.binTrips,x:"bin",y:"trips"}))),i.a.createElement("div",{className:"chart-detail"},"standard deviation ",i.a.createElement("span",{id:"std-dev"},e.stdDevDuration)))}var I=a(92);a(312);var O=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function T(e){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var t=e.installing;t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))}}}).catch(function(e){console.error("Error during service worker registration:",e)})}r.a.render(i.a.createElement(function(){var e=Object(n.useState)({populated:0,centerSkew:v.centerSkew(),startIndex:42,endIndex:505,list:[],latitude:v.randLat(),longitude:v.randLon(),minStationDist:0}),t=Object(s.a)(e,2),a=t[0],o=t[1],r=Object(n.useState)({useTime:!1,useProfile:!1}),d=Object(s.a)(r,2),m=d[0],u=d[1],p=Object(n.useState)(),g=Object(s.a)(p,2),f=g[0],k=g[1],E=Object(n.useState)({timeStr:"",isWeekday:0,isOvernight:0,isMorning:0,isAfternoon:0,isEvening:0}),S=Object(s.a)(E,2),y=S[0],N=S[1],x=Object(n.useState)({minDuration:"",maxDuration:"",averageDuration:"",stdDevDuration:"",labels:[],binTrips:[]}),O=Object(s.a)(x,2),T=O[0],L=O[1];function M(e){var t=v.findClosestStation(a.latitude,a.longitude,e);o(Object(c.a)({},a,{populated:a.populated+1,list:e,minStationDist:t.minDist,startIndex:t.minIndex}))}function C(e){if(console.log("pushed to trips ",JSON.stringify(e)),0===e.length)L({minDuration:0,maxDuration:0,averageDuration:"--:--",stdDevDuration:"--:--",binTrips:[]});else{console.log("tripStats ",e.length),e.sort(function(e,t){return e.tripDuration-t.tripDuration});var t=e.reduce(function(e,t){return e+t.tripDuration},0)/e.length;console.log("mean ".concat(t));var a=e.reduce(function(e,a){return e+Math.pow(a.tripDuration-t,2)},0)/(e.length>1?e.length-1:1),n=Math.sqrt(a);console.log("stdDev ".concat(n)),e=e.filter(function(e){return Math.abs(e.tripDuration-t)<=3*n}),t=e.reduce(function(e,t){return e+t.tripDuration},0)/e.length,console.log("mean (reduce) ".concat(t)),a=e.reduce(function(e,a){return e+Math.pow(a.tripDuration-t,2)},0)/(e.length>1?e.length-1:1),n=Math.sqrt(a),console.log("stdDev (reduce) ".concat(n));for(var i=e[e.length-1].tripDuration-e[0].tripDuration,o=e[0].tripDuration,r=.1*i,l=0,c=[],s=[],d=0,m=0;m<10&&d<e.length;m++){for(var u=0;d<e.length&&e[d].tripDuration<o+(m+1)*r;)u++,d++;u>l&&(l=u),s.push("".concat(m%2?"-":W((m+.5)*r+o))),c.push({bin:m+1,trips:u})}console.log("baseDuration ".concat(o," durationStep ").concat(r)),console.log("avgD ".concat(t," s =").concat(Math.floor(t/60)+":"+t%60," stdDev ").concat(n," s = ").concat(Math.floor(n/60)+":"+n%60)),console.log("maxbinCt ".concat(l),JSON.stringify(c)),L({minDuration:e[0].tripDuration,maxDuration:e[e.length-1].tripDuration,averageDuration:W(t),stdDevDuration:W(n),labels:s,binTrips:c})}}function j(){var e=Object(I.getTimeStr)(),t=Object(I.getTimeFlags)(e);N({timeStr:e,isWeekday:t.isWeekday,isOvernight:t.isOvernight,isMorning:t.isMorning,isAfternoon:t.isAfternoon,isEvening:t.isEvening})}function W(e){var t=Math.floor(e%60);return Math.floor(e/60)+":"+(t=t<10?"0"+t:t)}return Object(n.useEffect)(function(){a.list.length||(setInterval(j,1e3),k(!0),h.getStations(M))},[]),a.list.length?i.a.createElement("div",{className:"container AppBar"},i.a.createElement("div",{className:"row AppBar-header"},i.a.createElement("div",{id:"nameBox"},i.a.createElement("h5",null,"rguthrie's"),i.a.createElement("h4",null,"Divvy Bikes Planner"),i.a.createElement("div",{className:"smallprint"},i.a.createElement("br",null),i.a.createElement("p",null,"copyright \xa9 rguthrie, 2020"))),i.a.createElement("h1",{className:"AppBar-title"},"Bike Chicago!")),i.a.createElement("div",{className:"row"},i.a.createElement("div",{className:"col-sm-4"},i.a.createElement("div",{className:"row info-card"},i.a.createElement(b,{timeAndDate:y.timeStr,isWeekday:y.isWeekday,partOfDay:y.isOvernight?"overnight":y.isMorning?"morning":y.isEvening?"evening":"afternoon",lat:a.latitude.toPrecision(8),lon:a.longitude.toPrecision(8),startStation:a.populated?a.list[a.startIndex].stationId:"",startName:a.populated?a.list[a.startIndex].stationName:"",endStation:a.populated?a.list[a.endIndex].stationId:"",endName:a.populated?a.list[a.endIndex].stationName:"",minStationDist:a.minStationDist.toPrecision(3),useTime:m.useTime,useProfile:m.useProfile,whereAmI:function(e){e.preventDefault();var t=v.randLat(),n=v.randLon(),i=v.findClosestStation(t,n,a.list);o(Object(c.a)({},a,{latitude:t,longitude:n,minStationDist:i.minDist,startIndex:i.minIndex})),h.getTrips(a,m,C)},clickStart:f,handleRadio:function(e){e.preventDefault();var t=e.target.name,a=e.target.value;u(Object(c.a)({},m,Object(l.a)({},t,"yes"===a)))},handleClickStart:function(e){e.preventDefault();var t=e.target.value;k("start"===t)}})),i.a.createElement("div",{className:"row chart-card"},i.a.createElement(w,{minDuration:T.minDuration,maxDuration:T.maxDuration,averageDuration:T.averageDuration,stdDevDuration:T.stdDevDuration,labels:T.labels,binTrips:T.binTrips}))),i.a.createElement("div",{className:"col-sm-8"},i.a.createElement(D,{centerSkew:{key:a.centerSkew},centerLat:a.latitude,centerLon:a.longitude,stations:a.populated?a.list:[],startStation:a.populated?a.list[a.startIndex]:{},endStation:a.populated?a.list[a.endIndex]:{},mapClick:function(e){var t=e.x,n=e.y,i=e.lat,r=e.lng;console.log(t,n,i,r);var l=v.findClosestStation(i,r,a.list);o(Object(c.a)({},a,{latitude:f?i:a.latitude,longitude:f?r:a.longitude,minStationDist:f?l.minDist:a.minStationDist,startIndex:f?l.minIndex:a.startIndex,endIndex:f?a.endIndex:l.minIndex})),h.getTrips(a,m,C)}})))):i.a.createElement("div",null,"waiting for key")},null),document.getElementById("root")),function(){if("serviceWorker"in navigator){if(new URL("",window.location).origin!==window.location.origin)return;window.addEventListener("load",function(){var e="".concat("","/service-worker.js");O?function(e){fetch(e).then(function(t){404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):T(e)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(e):T(e)})}}()},89:function(e,t){e.exports={debug:!1}},92:function(e,t){var a=[15836544e5,1604214e6];e.exports={getTimeStr:function(){var e=Date.now();e<a[0]?e-=216e5:e<a[1]&&(e-=18e6);var t=new Date(e);return(t=t.toUTCString()).slice(0,25)+" CT"},getTimeFlags:function(e){var t=e.split(" "),a=!1;switch(t[0]){case"Mon,":case"Tue,":case"Wed,":case"Thu,":case"Fri,":a=!0;break;case"Sat,":case"Sun,":a=!1}var n=t[4].split(":")[0],i=!1,o=!1,r=!1,l=!1;return n<6?l=!0:n<12?i=!0:n<18?o=!0:r=!0,{isWeekday:a,isMorning:i,isAfternoon:o,isEvening:r,isOvernight:l}},makeLocalTime:function(e,t){var a={},n=new Date(1e3*(e+t)).toUTCString().split(" ");switch(a.year=n[3],a.monthNameShort=n[2],n[2]){case"Jan":a.month=1,a.monthName="January";break;case"Feb":a.month=2,a.monthName="February";break;case"Mar":a.month=3,a.monthName="March";break;case"Apr":a.month=4,a.monthName="April";break;case"May":a.month=5,a.monthName="May";break;case"Jun":a.month=6,a.monthName="June";break;case"Jul":a.month=7,a.monthName="July";break;case"Aug":a.month=8,a.monthName="August";break;case"Sep":a.month=9,a.monthName="September";break;case"Oct":a.month=10,a.monthName="October";break;case"Nov":a.month=11,a.monthName="November";break;case"Dec":a.month=12,a.monthName="December"}switch(a.dayOfMonth=n[1],n[0]){case"Mon,":a.dayOfWeek="Monday";break;case"Tue,":a.dayOfWeek="Tuesday";break;case"Wed,":a.dayOfWeek="Wednesday";break;case"Thu,":a.dayOfWeek="Thursday";break;case"Fri,":a.dayOfWeek="Friday";break;case"Sat,":a.dayOfWeek="Saturday";break;case"Sun,":a.dayOfWeek="Sunday"}var i=n[4].split(":");return a.hour=i[0],a.minute=i[1],a.second=i[2],a}}}},[[159,1,2]]]);
//# sourceMappingURL=main.01f601a1.chunk.js.map